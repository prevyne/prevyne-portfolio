<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prevyne Okech Odhiambo - Portfolio</title>
  <meta name="description" content="Prevyne Okech â€” Full Stack Developer (Django, MERN, Flask). Portfolio and project showcase." />
  <meta name="keywords" content="Prevyne Okech, Django, React, Flask, Full-Stack Developer, Kenya, Portfolio" />
  <meta name="author" content="Prevyne Okech" />
  <meta property="og:title" content="Prevyne Okech | Software Engineer" />
  <meta property="og:description" content="Portfolio of Prevyne Okech â€” Full Stack Developer specializing in Django, MERN and Flask." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="assets/images/profile_best.jpg" />
  <meta property="og:url" content="https://prevyne.dev/" />
  <link rel="icon" href="assets/images/profile_best.jpg" type="image/png" />

  <script src="https://cdn.tailwindcss.com" defer></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    :root{
      --bg:#0A0A1A;
      --primary:#00BFFF;
      --primary-rgb:0,191,255;
      --accent:#64FFDA;
      --card:#101827;
      --glass: rgba(16,24,39,0.82);
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family:'Roboto Mono', monospace;
      background:var(--bg);
      color:#E0E0E0;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      scroll-behavior:smooth;
    }

    /* Preloader */
    #preloader{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg, rgba(0,0,0,0.88), rgba(10,10,26,0.96));
      z-index:9999;flex-direction:column;gap:12px;
    }
    /* Moved from inline style */
    .preloader-img {
      width:88px;
      height:88px;
      border-radius:999px;
      border:3px solid rgba(100,255,218,0.08);
      object-fit:cover;
      box-shadow:0 8px 40px rgba(0,191,255,0.06);
    }
    .loader-bar{
      width:240px;height:10px;border-radius:999px;background:rgba(255,255,255,0.04);overflow:hidden;
      box-shadow:0 0 24px rgba(var(--primary-rgb),0.06) inset;
    }
    .loader-bar > i{
      display:block;height:100%;width:0%;
      background:linear-gradient(90deg,var(--primary),#0077b3);
      box-shadow:0 0 26px rgba(var(--primary-rgb),0.28);
      transition:width 600ms ease;
    }
    #preloader p{color:#9CA3AF;margin:0;font-size:0.98rem;letter-spacing:0.6px;}

    /* Layout */
    nav{position:fixed;inset:0 0 auto 0;z-index:60;background:rgba(0,0,0,0.45);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.04)}
    .container{max-width:1100px;margin:0 auto;padding:0 1rem}

    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:0.75rem 0}
    .brand{font-weight:700;color:#fff}
    .nav-links{display:flex;gap:1.25rem;align-items:center}
    .nav-link{position:relative;color:#cbd5e1;text-decoration:none;padding-bottom:4px}
    .nav-link:after{content:"";position:absolute;left:0;bottom:0;height:2px;width:100%;background:var(--primary);transform:scaleX(0);transform-origin:right;transition:transform 250ms ease}
    .nav-link:hover:after,.nav-link.active:after{transform:scaleX(1);transform-origin:left}
    
    .menu-btn{
      display:none; /* Shown in media query */
      background:transparent;
      border:0;
      cursor:pointer;
      color:rgba(100,255,218,0.9); /* Moved from inline */
      font-size:20px; /* Moved from inline */
    }

    /* Mobile Nav Menu */
    #mobileNav{
      display:none; /* Toggled by JS */
      background:rgba(0,0,0,0.6);
      padding:0.5rem;
    }
    /* This class is added by JS to show the menu */
    #mobileNav.is-open {
      display: block;
    }
    #mobileNav .container{
      display:flex;
      flex-direction:column;
      gap:8px
    }

    /* Sections */
    .section{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:6rem 1rem;position:relative;overflow:hidden;background:var(--bg)}
    .section-inner{z-index:2;width:100%;max-width:1100px;margin:0 auto}
    .visible{opacity:1;transform:none}
    
    /* Centralized Section Title (moved from inline) */
    .section-title {
      color:var(--accent);
      font-size:2rem;
      font-weight:700;
      text-align:center;
      margin-bottom:1.25rem;
    }

    /* Hero specifics */
    #hero{position:relative;}
    #hero-canvas{position:absolute;inset:0;width:100%;height:100%;z-index:0;display:block}
    #hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(10,10,26,0.6) 0%, rgba(10,10,26,0.9) 100%);z-index:0}
    .hero-content{position:relative;z-index:1;text-align:center;padding-top:3rem}
    .hero-title{font-size:clamp(2rem,5vw,4rem);line-height:1.02;color:var(--accent);font-weight:700}
    .hero-title {
      position: relative;
      color: var(--accent);
      animation: glitch 1.2s infinite;
    }
    .hero-title::before,
    .hero-title::after {
      content: attr(data-text);
      position: absolute;
      left: 0;
      width: 100%;
      color: var(--accent);
      clip: rect(0, 900px, 0, 0);
    }
    .hero-title::before {
      animation: glitchTop 1.5s infinite linear alternate-reverse;
      color: #ff00c8;
    }
    .hero-title::after {
      animation: glitchBottom 1.5s infinite linear alternate-reverse;
      color: #00fff2;
    }
    .hero-sub{color:#93C5FD;margin-top:0.75rem}
    .hero-ctas{margin-top:1.5rem;display:flex;gap:0.75rem;justify-content:center;flex-wrap:wrap}

    .btn-primary{background:var(--primary);color:#041025;padding:0.85rem 1.25rem;border-radius:10px;font-weight:700;border:2px solid rgba(0,191,255,0.12);box-shadow:0 8px 30px rgba(var(--primary-rgb),0.06);text-decoration:none;display:inline-flex;align-items:center;gap:0.6rem;transition:transform 150ms ease,box-shadow 150ms}
    .btn-primary:hover{transform:translateY(-3px);box-shadow:0 18px 40px rgba(var(--primary-rgb),0.12)}
    .btn-ghost{border:1px solid rgba(255,255,255,0.06);padding:0.75rem 1rem;border-radius:8px;color:#cfe9ff;text-decoration:none}

    /* About Section Styles (moved from inline) */
    .about-grid {
      align-items:center;
      gap:1.25rem;
    }
    .about-image-wrapper {
      display:flex;
      justify-content:center;
    }
    .about-img {
      width:220px;
      height:220px;
      border-radius:12px;
      object-fit:cover;
      border:4px solid rgba(100,255,218,0.06);
    }
    .about-text {
      color:#cbd5e1;
      line-height:1.6;
    }
    
    /* Education & Skills Grid */
    .section-grid {
      margin-top:0.75rem;
    }
    /* Card padding (moved from inline) */
    #education .card, #skills .card {
      padding: 1rem;
    }
    
    /* Cards */
    .grid{display:grid;gap:1.25rem}
    .projects-grid{grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
    .card{background:var(--glass);border-radius:0.75rem;border:1px solid rgba(var(--primary-rgb),0.12);overflow:hidden;position:relative;transition:transform 300ms ease,box-shadow 300ms}
    .card:hover{transform:translateY(-8px);box-shadow:0 20px 50px rgba(var(--primary-rgb),0.06)}
    .card img{width:100%;height:160px;object-fit:cover;display:block}
    .card-body{padding:1rem}
    .card-title{font-weight:700;color:#fff;margin-bottom:0.5rem}
    .card-desc{color:#9CA3AF;font-size:0.95rem;margin-bottom:0.75rem}

    /* overlay buttons */
    .card-overlay{
      position:absolute;inset:0;display:flex;align-items:center;justify-content:center;gap:0.5rem;
      background:linear-gradient(180deg, rgba(2,6,23,0.0), rgba(2,6,23,0.6));opacity:0;transition:opacity 220ms ease;
    }
    .card:hover .card-overlay{opacity:1}
    .overlay-btn{padding:0.6rem 0.9rem;border-radius:8px;background:rgba(0,0,0,0.45);backdrop-filter:blur(4px);color:var(--primary);text-decoration:none;border:1px solid rgba(var(--primary-rgb),0.14);font-weight:700}

    /* skill/education grid */
    .small-grid{grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}

    /* Contact Section Styles */
    .contact-grid {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:1.25rem;
    }
    .contact-vectors h3 {
      font-weight:700;
      color:#fff;
    }
    .contact-vectors p {
      color:#cbd5e1;
    }
    /* Replaced Tailwind text-sky-400 with our CSS var */
    .contact-vectors .fas, .contact-vectors .fab {
      color: var(--primary);
      margin-right: 0.5rem; /* Added for spacing */
    }
    .contact-socials {
      display:flex;
      gap:0.5rem;
      margin-top:0.6rem;
    }
    .contact-socials a {
      color:#cbd5e1;
      font-size: 1.5rem; /* Replaces fa-2x */
    }

    /* contact form */
    .form-label {
      color:#cbd5e1;
      font-weight:600;
      font-size:0.9rem;
      display: block; /* Ensures it's on its own line */
      margin-bottom: 0.25rem; /* Adds space above input */
    }
    .form-input{background:#1F2937;border:1px solid #4B5563;color:#F3F4F6;padding:0.75rem;border-radius:8px;width:100%}
    .form-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 15px rgba(var(--primary-rgb),0.12)}
    /* Fix for textarea resize */
    textarea.form-input {
      resize: vertical;
      min-height: 100px;
    }

    /* audio control */
    .audio-toggle{
      position:fixed;right:20px;bottom:20px;z-index:80;background:rgba(3,7,18,0.6);border-radius:999px;padding:12px;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(6px);
      border:1px solid rgba(255,255,255,0.04);opacity:0;transform:translateY(12px);transition:opacity 250ms ease,transform 250ms ease;
    }
    .audio-toggle.visible{opacity:1;transform:translateY(0)}
    .audio-toggle .icon{font-size:18px;color:rgba(148,163,184,1);transition:color 160ms ease,filter 160ms}
    .audio-toggle.active .icon{color:var(--primary);filter:drop-shadow(0 0 10px rgba(var(--primary-rgb),0.9))}
    .audio-tooltip{position:absolute;bottom:60px;right:0;background:rgba(0,0,0,0.7);color:#cbd5e1;padding:6px 8px;border-radius:6px;font-size:13px;opacity:0;transform:translateY(6px);transition:opacity 200ms ease,transform 200ms ease;pointer-events:none}
    .audio-toggle:hover .audio-tooltip{opacity:1;transform:translateY(0)}

    /* footer */
    footer{padding:2rem 1rem;text-align:center;border-top:1px solid rgba(255,255,255,0.03);color:#9CA3AF}
    /* Added container class to footer content */
    footer .container {
      max-width:1100px;
      margin:0 auto;
      padding:0 1rem;
    }

    /* responsive tweaks */
    @media (max-width:768px){
      .nav-links{display:none}
      .menu-btn{display:inline-block}
      .section{padding:4rem 1rem}
      .card img{height:140px}
      .audio-toggle{right:12px;bottom:12px}

      /* --- ðŸš€ THIS IS THE RESPONSIVE FIX --- */
      /* This rule now works because the inline style is gone */
      .contact-grid {
        grid-template-columns: 1fr; /* Stack the columns */
        gap: 2rem; /* Add space between them */
      }
    }
    @media (max-width:480px){
      .hero-title{font-size:1.6rem}
      .card img{height:120px}
      .loader-bar{width:180px}
    }

    /* Glitch effect (Unchanged) */
    .glitch {
            position: relative;
            color: white;
            animation: glitch-skew 1s infinite linear alternate-reverse;
        }
        .glitch::before,
        .glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--background-dark);
            overflow: hidden;
        }
        .glitch::before {
            left: 2px;
            text-shadow: -2px 0 var(--secondary-glow);
            animation: glitch-anim-1 2s infinite linear alternate-reverse;
        }
        .glitch::after {
            left: -2px;
            text-shadow: -2px 0 var(--primary-glow), 2px 2px var(--secondary-glow);
            animation: glitch-anim-2 3s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim-1 { 0% { clip-path: inset(15% 0 86% 0); } 100% { clip-path: inset(80% 0 3% 0); } }
        @keyframes glitch-anim-2 { 0% { clip-path: inset(50% 0 40% 0); } 100% { clip-path: inset(10% 0 75% 0); } }
        @keyframes glitch-skew { 0% { transform: skewX(0deg); } 100% { transform: skewX(0.5deg); } }

  </style>
</head>
<body>

  <div id="preloader" aria-hidden="true">
    <img src="assets/images/profile_best.jpg" alt="Prevyne Okech" class="preloader-img">
    <p>Launching Portfolio Interfaceâ€¦</p>
    <div class="loader-bar"><i id="loader-bar-inner"></i></div>
  </div>

  <nav>
    <div class="container nav-inner">
      <a class="brand" href="#">PREVYNE_OKECH</a>
      <div class="nav-links" role="navigation" aria-label="Primary">
        <a class="nav-link" href="#hero">Home</a>
        <a class="nav-link" href="#about">About</a>
        <a class="nav-link" href="#education">Education</a>
        <a class="nav-link" href="#skills">Skills</a>
        <a class="nav-link" href="#projects">Projects</a>
        <a class="nav-link" href="#contact">Contact</a>
      </div>
      <button class="menu-btn" id="menuBtn" aria-expanded="false" aria-label="Open menu">
        <i class="fas fa-bars"></i>
      </button>
    </div>
    <div id="mobileNav">
      <div class="container">
        <a class="nav-link" href="#hero">Home</a>
        <a class="nav-link" href="#about">About</a>
        <a class="nav-link" href="#education">Education</a>
        <a class="nav-link" href="#skills">Skills</a>
        <a class="nav-link" href="#projects">Projects</a>
        <a class="nav-link" href="#contact">Contact</a>
      </div>
    </div>
  </nav>

  <section id="hero" class="section" aria-label="Hero">
    <canvas id="hero-canvas" aria-hidden="true"></canvas>
    <div class="section-inner hero-content">
      <h1 class="hero-title glitch" aria-level="1" data-text="Okech Prevyne Odhiambo">Okech Prevyne Odhiambo</h1>
      <p class="hero-sub">Software Engineer / Virtual Assistant / Web Developer</p>
      <div class="hero-ctas">
        <a class="btn-primary" href="#contact">Initiate Contact</a>
        <a class="btn-ghost" href="assets/resume/Prevyne_Okech_Resume.pdf" download>Download Resume</a>
      </div>
    </div>
  </section>

  <section id="about" class="section" aria-label="About">
    <div class="section-inner">
      <h2 class="section-title">About Me</h2>
      <div class="grid small-grid about-grid">
        <div class="about-image-wrapper">
          <img src="assets/images/profile_best.jpg" alt="Prevyne Okech portrait" class="about-img" loading="lazy">
        </div>
        <div>
          <p class="about-text">
            I am a full stack software engineer and web applications developer with over four years of experience, specializing in the M.E.R.N stack and Django. My mission is to use technology to build digital products and provide pragmatic solutions for enterprises and SMEs.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section id="education" class="section" aria-label="Education">
    <div class="section-inner">
      <h2 class="section-title">Education</h2>
      <div class="grid small-grid section-grid">
        <div class="card">
          <h3 class="card-title">BSc in Information Technology</h3>
          <p class="card-desc">Kabarak University, Kenya â€” Graduated Dec 2024</p>
        </div>
        <div class="card">
          <h3 class="card-title">Virtual Assistance</h3>
          <p class="card-desc">ALX Academy Africa â€” Graduated Sep 2024</p>
        </div>
        <div class="card">
          <h3 class="card-title">Back-end Pro-dev Web Dev</h3>
          <p class="card-desc">ALX Academy Africa â€” Graduated October 2025</p>
        </div>
        <div class="card">
          <h3 class="card-title">Software Engineering</h3>
          <p class="card-desc">Power Learn Project Africa â€” Febâ€“Jul 2025</p>
        </div>
      </div>
    </div>
  </section>

  <section id="skills" class="section" aria-label="Skills">
    <div class="section-inner">
      <h2 class="section-title">Skillset Matrix</h2>
      <div class="grid projects-grid section-grid">
        <div class="card">
          <h3 class="card-title">Web Development</h3>
          <p class="card-desc">HTML5, CSS3, JavaScript (ES6+), React.js, Node.js, Django, Flask</p>
        </div>
        <div class="card">
          <h3 class="card-title">Software Engineering</h3>
          <p class="card-desc">Python, C/C++, Git, Docker, DevOps essentials, SQLAlchemy</p>
        </div>
        <div class="card">
          <h3 class="card-title">Virtual Assistance</h3>
          <p class="card-desc">Email management, Data entry, Social media management, Google Workspaces</p>
        </div>
        <div class="card">
          <h3 class="card-title">Soft Skills</h3>
          <p class="card-desc">Problem-solving, Communication, Teamwork, Time management</p>
        </div>
      </div>
    </div>
  </section>

  <section id="projects" class="section" aria-label="Projects">
    <div class="section-inner">
      <h2 class="section-title">Project Showcase</h2>
      <div class="grid projects-grid section-grid">
        <div class="card">
          <img src="src/kazi-match.jpg" alt="Kazi-Match" loading="lazy">
          <div class="card-overlay">
            <a class="overlay-btn" href="https://kazi-match.vercel.app/" target="_blank" rel="noreferrer">Live Demo</a>
            <a class="overlay-btn" href="https://github.com/prevyne/KaziMatch" target="_blank" rel="noreferrer">GitHub</a>
          </div>
          <div class="card-body">
            <h3 class="card-title">Kazi-Match Platform</h3>
            <p class="card-desc">A Django + React platform that matches candidates with suitable jobs based on their skills.</p>
          </div>
        </div>

        <div class="card">
          <img src="src/Chatbot_2.png" alt="General Enquiry Chatbot" loading="lazy">
          <div class="card-overlay">
            <a class="overlay-btn" href="https://chatbot-0zdm.onrender.com/" target="_blank" rel="noreferrer">Live Demo</a>
            <a class="overlay-btn" href="https://github.com/prevyne/General-enquiry-chatbot" target="_blank" rel="noreferrer">GitHub</a>
          </div>
          <div class="card-body">
            <h3 class="card-title">General Enquiry Chatbot</h3>
            <p class="card-desc">A Flask chatbot with Tailwind styling to handle general enquiries.</p>
        </div>
        </div>

        <div class="card">
          <img src="src/chatbot.png" alt="Admissions Enquiry Bot" loading="lazy">
          <div class="card-overlay">
            <a class="overlay-btn" href="https://github.com/prevyne/College-Admissions-Enquiry-Chatbot-with-Python" target="_blank" rel="noreferrer">View Source</a>
            <a class="overlay-btn" href="#" onclick="return false;">Live Demo</a>
          </div>
          <div class="card-body">
            <h3 class="card-title">Admissions Enquiry Bot</h3>
            <p class="card-desc">College admissions enquiry bot written with Flask & ChatterBot.</p>
          </div>
        </div>

      </div>
    </div>
  </section>

  <section id="contact" class="section" aria-label="Contact">
    <div class="section-inner">
      <h2 class="section-title">Establish Connection</h2>
      <div class="contact-grid">
        <div class="contact-vectors">
          <h3>Contact Vectors</h3>
          <p><i class="fas fa-envelope"></i> prevyneoketch6@gmail.com</p>
          <p><i class="fas fa-phone"></i> +254712918350</p>
          <p><i class="fas fa-map-marker-alt"></i> Nakuru, Kenya</p>
          <div class="contact-socials">
            <a href="https://github.com/prevyne" target="_blank" rel="noreferrer" aria-label="GitHub"><i class="fab fa-github"></i></a>
            <a href="https://www.linkedin.com/in/prevyne-okech" target="_blank" rel="noreferrer" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
          </div>
        </div>

        <form id="contact-form" class="space-y-4" aria-label="Contact form">
          <div>
            <label for="name" class="form-label">Your Alias</label>
            <input id="name" name="name" class="form-input" required>
          </div>

          <div>
            <label for="email" class="form-label">Your Secure Email</label>
            <input id="email" name="email" type="email" class="form-input" required>
          </div>

          <div>
            <label for="message" class="form-label">Message Payload</label>
            <textarea id="message" name="message" rows="5" class="form-input" required></textarea>
          </div>

          <button type="submit" class="btn-primary" aria-label="Send message">Transmit Message</button>
        </form>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <p>&copy; <span id="year"></span> Prevyne Okech Odhiambo. All rights reserved.</p>
    </div>
  </footer>

  <audio id="bg-audio" preload="auto" loop>
    <source src="https://assets.pixabay.com/audio/2024/05/08/audio_1e59170846.mp3" type="audio/mpeg">
    <source src="assets/audio/hope-166419.mp3" type="audio/mpeg">
  </audio>

  <div id="audio-toggle" class="audio-toggle" role="button" aria-label="Toggle Sound" tabindex="0">
    <div class="audio-tooltip">Toggle Sound</div>
    <i class="fas fa-headphones icon" aria-hidden="true"></i>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" defer></script>

  <script>
    // Small helper
    const qs = (s) => document.querySelector(s);
    const qsa = (s) => document.querySelectorAll(s); // Added helper

    // Preloader animation
    document.addEventListener('DOMContentLoaded', () => {
      const loader = qs('#loader-bar-inner');
      let progress = 0;
      const tick = () => {
        progress = Math.min(100, progress + Math.random()*18);
        loader.style.width = progress + '%';
        if (progress < 100) setTimeout(tick, 240);
      };
      tick();
    });

    // Ensure Three.js init waits until THREE is available
    function whenThreeReady(cb, timeout = 5000) {
      const start = Date.now();
      const iv = setInterval(() => {
        if (window.THREE) { clearInterval(iv); cb(); }
        if (Date.now() - start > timeout) { clearInterval(iv); console.warn('THREE did not load in time'); }
      }, 50);
    }

    // When everything (including deferred scripts and images) is ready
    window.addEventListener('load', () => {
      // Hide preloader gracefully
      const pre = qs('#preloader');
      pre.style.transition = 'opacity 400ms ease';
      pre.style.opacity = 0;
      setTimeout(() => pre.parentNode && pre.parentNode.removeChild(pre), 600);

      // mark nav active and set year
      qs('.nav-link[href="#hero"]').classList.add('active');
      qs('#year').textContent = new Date().getFullYear();

      // Intersection reveal
      const sections = qsa('.section'); // Use helper
      const io = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            entry.target.querySelectorAll('.card').forEach((c,i)=> c.style.transitionDelay = `${i*60}ms`);
          }
        });
      }, {threshold:0.14});
      sections.forEach(s => io.observe(s));

      // Show audio toggle only when hero is visible
      const audioToggle = qs('#audio-toggle');
      const hero = qs('#hero');
      const heroObserver = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) audioToggle.classList.add('visible');
          else audioToggle.classList.remove('visible');
        });
      }, {threshold: 0.35});
      heroObserver.observe(hero);

      // Navbar active highlight on scroll
      window.dispatchEvent(new Event('scroll'));
    });

    // --- ðŸš€ UPGRADED Mobile Nav Toggle ---
    const menuBtn = qs('#menuBtn');
    const mobileNav = qs('#mobileNav');
    const menuIcon = qs('#menuBtn .fas'); // Get the icon itself

    if (menuBtn && mobileNav && menuIcon) {
      menuBtn.addEventListener('click', () => {
        const expanded = menuBtn.getAttribute('aria-expanded') === 'true';
        menuBtn.setAttribute('aria-expanded', String(!expanded));
        
        // Toggle a class on the nav element
        mobileNav.classList.toggle('is-open');

        // Toggle the icon
        if (mobileNav.classList.contains('is-open')) {
          menuIcon.classList.remove('fa-bars');
          menuIcon.classList.add('fa-times');
        } else {
          menuIcon.classList.remove('fa-times');
          menuIcon.classList.add('fa-bars');
        }
      });

      // --- âœ¨ NEW: Close menu when a link is clicked ---
      qsa('#mobileNav .nav-link').forEach(link => {
        link.addEventListener('click', () => {
          menuBtn.setAttribute('aria-expanded', 'false');
          mobileNav.classList.remove('is-open');
          menuIcon.classList.remove('fa-times');
          menuIcon.classList.add('fa-bars');
        });
      });
    }

    // Navbar glow on scroll & active link
    window.addEventListener('scroll', () => {
      const nav = qs('nav'); // Use helper
      if (window.scrollY > 80) nav.style.boxShadow = '0 8px 40px rgba(0,191,255,0.06)';
      else nav.style.boxShadow = 'none';

      const scrollPos = window.scrollY + window.innerHeight/2;
      qsa('.section').forEach(section => { // Use helper
        const id = section.id;
        const link = qs('.nav-link[href="#' + id + '"]'); // Use helper
        if (section.offsetTop <= scrollPos && section.offsetTop + section.offsetHeight > scrollPos) {
          qsa('.nav-link').forEach(l => l.classList.remove('active')); // Use helper
          if (link) link.classList.add('active');
        }
      });
    });

    // EmailJS contact (deferred)
    window.addEventListener('load', () => {
      try { emailjs.init('iAC4BvOGycdAcvDLA'); } catch(e){}
      const form = qs('#contact-form');
      if (form) {
        form.addEventListener('submit', (ev) => {
          ev.preventDefault();
          const serviceID = 'service_6iv1go7';
          const templateID = 'template_u322tjj';
          const btn = form.querySelector('button[type="submit"]');
          btn.disabled = true; btn.style.opacity = 0.7;
          emailjs.sendForm(serviceID, templateID, form)
            .then(() => { alert('Message transmitted successfully!'); form.reset(); })
            .catch(err => { console.error('EmailJS Error', err); alert('Transmission failed. Check connection.'); })
            .finally(()=>{ btn.disabled = false; btn.style.opacity = 1; });
        });
      }
    });

    // THREE.JS PARTICLES (Unchanged from your file)
    whenThreeReady(() => {
      try {
        const canvas = qs('#hero-canvas');
        const renderer = new THREE.WebGLRenderer({ canvas, alpha:true, antialias: true });
        renderer.setClearColor(0x000000, 0);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        camera.position.z = 50;

        // adaptive particle count
        const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent) || window.innerWidth < 900;
        const PARTICLE_COUNT = isMobile ? 3000 : 6500;

        const positions = new Float32Array(PARTICLE_COUNT * 3);
        const sizes = new Float32Array(PARTICLE_COUNT);
        const colors = new Float32Array(PARTICLE_COUNT * 3);

        for (let i = 0; i < PARTICLE_COUNT; i++) {
          const i3 = i * 3;
          const radius = (Math.random() - 0.5) * 160;
          positions[i3] = (Math.random() - 0.5) * 160; // x
          positions[i3 + 1] = (Math.random() - 0.5) * 100; // y
          positions[i3 + 2] = (Math.random() - 0.5) * 200; // z (depth)
          sizes[i] = Math.random() * 0.9 + 0.1;
          const r = 0.0 + Math.random() * 0.02;
          const g = 0.78 + Math.random() * 0.05;
          const b = 1.0;
          colors[i3] = r; colors[i3+1] = g; colors[i3+2] = b;
        }

        const geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        geometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
        geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

        // PointsMaterial with size attenuation
        const material = new THREE.PointsMaterial({
          vertexColors: false,
          color: 0x00BFFF,
          size: isMobile ? 0.08 : 0.12,
          transparent: true,
          blending: THREE.AdditiveBlending,
          depthWrite: false,
        });

        const points = new THREE.Points(geometry, material);
        scene.add(points);

        // gentle rotation and flicker parameters
        let mouseX = 0, mouseY = 0;
        let targetX = 0, targetY = 0;
        const clock = new THREE.Clock();

        function onMove(e) {
          mouseX = (e.clientX - window.innerWidth / 2) / 10;
          mouseY = (e.clientY - window.innerHeight / 2) / 12;
        }
        window.addEventListener('mousemove', onMove, { passive: true });

        function animate() {
          requestAnimationFrame(animate);
          const t = Date.now() * 0.00012;
          // parallax smoothing
          targetX += (mouseX - targetX) * 0.05;
          targetY += (mouseY - targetY) * 0.05;
          camera.position.x = targetX;
          camera.position.y = -targetY;
          camera.lookAt(scene.position);

          // subtle rotation & flicker
          points.rotation.y = t * 0.28;
          const positionsAtt = geometry.attributes.position.array;
          const len = positionsAtt.length;
          for (let i = 2; i < len; i += 3) {
            // slight z wobble for shimmer effect
            positionsAtt[i] += Math.sin((i + t * 1000) * 0.0003) * 0.0008;
          }
          geometry.attributes.position.needsUpdate = true;

          renderer.render(scene, camera);
        }

        function onResize() {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
        }
        window.addEventListener('resize', onResize);

        // set renderer size initially
        onResize();
        animate();
      } catch (err) {
        console.error('Three.js init error', err);
      }
    }, 6000);

    // Audio control (Unchanged from your file)
    (function setupAudioUI(){
      const audio = qs('#bg-audio');
      const toggle = qs('#audio-toggle');
      const icon = toggle.querySelector('.icon');
      let isPlaying = false;

      // small audio analyser for pulse effect (graceful degradation)
      let analyser, audioCtx, sourceNode;
      function tryCreateAnalyser() {
        try {
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
          sourceNode = audioCtx.createMediaElementSource(audio);
          analyser = audioCtx.createAnalyser();
          analyser.fftSize = 256;
          sourceNode.connect(analyser);
          analyser.connect(audioCtx.destination);
        } catch (e) {
          analyser = null;
        }
      }

        // toggle playback
      function togglePlay() {
        if (!audio) return;
        if (!isPlaying) {
          // resume context if needed
          if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume().catch(()=>{});
          const p = audio.play();
          if (p && p.catch) p.catch(()=>{ /* autoplay prevented */ });
          toggle.classList.add('active');
          isPlaying = true;
        } else {
          audio.pause();
          toggle.classList.remove('active');
          isPlaying = false;
        }
      }

      // tooltip via title and explicit element already present
      toggle.addEventListener('click', () => {
        // first user gesture: ensure audio context allowed
        if (!audioCtx) tryCreateAnalyser();
        togglePlay();
      });

      // keyboard accessibility
      toggle.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle.click(); }
      });

      // animate pulse based on analyser (if available)
      function pulseLoop() {
        if (analyser && isPlaying) {
          const data = new Uint8Array(analyser.frequencyBinCount);
          analyser.getByteFrequencyData(data);
          let sum = 0;
          for (let i=0;i<data.length;i++) sum += data[i];
          const avg = sum / data.length;
          const scale = 1 + (avg / 900); // subtle
          icon.style.transform = `scale(${1 + (avg/2000)})`;
          icon.style.filter = `drop-shadow(0 0 ${4 + (avg/40)}px rgba(0,191,255,0.9))`;
        } else {
          icon.style.transform = '';
          icon.style.filter = '';
        }
        requestAnimationFrame(pulseLoop);
      }
      pulseLoop();

      // expose for debug
      window._portfolioAudio = { audio, toggle };
    })();

    // set year if not set earlier
    document.addEventListener('DOMContentLoaded', () => {
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();
    });

  </script>

</body>
</html>
